# ~/.bashrc: executed by bash(1) for non-login shells.

[ -z "$PS1" ] && return


#export PS1='\h:\w\$ '

# Pimp my prompt ;)
export COLOR_NC='\033[0m' # No Color
export COLOR_WHITE='\033[1;37m'
export COLOR_BLACK='\033[0;30m'
export COLOR_BLUE='\033[0;34m'
export COLOR_LIGHT_BLUE='\033[1;34m'
export COLOR_GREEN='\033[0;32m'
export COLOR_LIGHT_GREEN='\033[1;32m'
export COLOR_CYAN='\033[0;36m'
export COLOR_LIGHT_CYAN='\033[1;36m'
export COLOR_RED='\033[0;31m'
export COLOR_LIGHT_RED='\033[1;31m'
export COLOR_PURPLE='\033[0;35m'
export COLOR_LIGHT_PURPLE='\033[1;35m'
export COLOR_BROWN='\033[0;33m'
export COLOR_YELLOW='\033[1;33m'
export COLOR_GRAY='\033[1;30m'
export COLOR_LIGHT_GRAY='\033[0;37m'
alias colorslist="set | egrep 'COLOR_\w*'"  # lists all the colors

export PS1="${COLOR_GREEN}[\t ${COLOR_LIGHT_GREEN}\u@\h${COLOR_LIGHT_GREEN}]: \W ($?)#${COLOR_NC} "
umask 022

# History -------------------------------
export HISTCONTROL=ignoredups
export HISTFILESIZE=3000
export HISTIGNORE="ls:cd:[bf]g:exit:..:...:ll:lla:l"
alias h=history
hf(){
	grep "$@" ~/.bash_history
}

# Check window size and changes to the window size
shopt -s checkwinsize

bind "set bell-style none" # no bell

# use vi command mode
set -o vi

# Editors
export EDITOR='vim' #Command line
export GIT_EDITOR='vim'
alias v=vim

# Sluething----------------------------------------------------
findportuser() {
	lsof -i :"$1"
}

# Misc
alias ducks='du -cksh * | sort -rn | head -11' # list files and folders and there size
alias daemontail='tail -f /var/log/daemon.log'
alias messagetail='tail -f /var/log/messages'

# Shows most used commands, cool script I got this from: http://lifehacker.com/software/how-to/turbocharge-your-terminal-274317.php
alias profileme="history | awk '{print \$2}' | awk 'BEGIN{FS=\"|\"}{print \$1}' | sort | uniq -c | sort -n | tail -n 20 | sort -nr"
 

#use extra globing features. See man bash, search extglob.
#shopt -s extglob
#include .files when globbing.
#shopt -s dotglob
#When a glob expands to nothing, make it an empty string instead of the literal characters.
#shopt -s nullglob
# fix spelling errors for cd, only in interactive shell
#shopt -s cdspell

# ls colors, see: http://www.linux-sxs.org/housekeeping/lscolors.html
export LS_COLORS='di=1:fi=0:ln=31:pi=5:so=5:bd=5:cd=5:or=31:mi=0:ex=35:*.rb=90' #LS_COLORS is not supported by the default ls command in OS-X
export LS_OPTIONS='--color=auto'
eval "`dircolors`"
alias ls='ls $LS_OPTIONS'
alias ll='ls $LS_OPTIONS -l'
alias l='ls $LS_OPTIONS -lA'
alias sl='ls'
alias show='apt-cache show'
alias search='apt-cache search'
alias ff='ack-grep'

# git aliases
alias gt='git'
alias gtinit='git init'
alias gtclone='git clone'
alias gs='git status'
alias gc='git commit'
alias gm='git merge'
alias ga='git add'
alias gaa='git add .'
alias gpush='git push' 
alias gpull='git push' 
alias gd='git diff'
alias gds='git diff --cached'
alias gb='git branch'
alias gl='git log'
alias gsb='git show-branch'
alias gb='git branch'
alias gbd='git branch -d'
alias gba='git branch -a'
alias gco='git checkout'
alias gg='git grep'
alias gk='gitk --all'
alias gr='git rebase'
alias gri='git rebase --interactive'
alias gcp='git cherry-pick'
alias grm='git rm'
alias gmv='git move'
alias gsh='git show'
alias gmovelastcommittostaged='gt reset --soft HEAD^'

# functions taken from http://github.com/twerth/dotfiles/blob/master/etc/bashrc_app_specific

gtcommit(){
	gt commit -m "$@"
}
   
gtcommitall(){
	gt commit -a -v -m "$@"
}
	 
gtpushorigin(){
	gt push origin $@
}
	   
gtcheckout (){
	gt checkout $1
	gt branch
}
gtcheckouttrackingbranch (){
	gt checkout -tlb $1 origin/$1
	gt branch
}
			   
alias gtlog='gt log --name-status'
alias gtlogshort='gt log --pretty=oneline'
alias gtloggraph='gt log --graph'
gtlogforuser(){
	gtlog --author=$1
}
gtloggrep(){
	gtlog | grep $@ -B20 -A20
}
gtgrep(){
	gt grep -e "$@" | highlight green "$@" blue "^.*\:"
}

function ii(){
	NET=`netstat -rn | egrep UG | grep 0\.0\.0\.0 | awk '{print $8;}'`
#    clear
	echo -e "\nYou are logged on ${red}$HOSTNAME"
	echo -e "\nAdditional information:$NC " ; uname -a
	echo -e "\n${red}Users logged on:$NC " ; w -h
	echo -e "\n${red}Current date :$NC " ; date
	echo -e "\n${red}Machine stats :$NC " ; uptime
	echo -e "\n${red}Memory stats :$NC " ; free
	echo -e "\n${red}Disk usage :$NC " ; df -lh
	echo -e "\n${red}Local IP Address :$NC" ; 
	/sbin/ifconfig $NET | awk '/inet/ { print $2 } ' | sed -e s/addr://
#    echo -e "----------------------------------------------------------------------\n"
}

# ssh aliases
alias keyon="ssh-add -t 10800"
alias keyoff='ssh-add -D'
alias keylist='ssh-add -l'

# Some more alias to avoid making mistakes:
# alias rm='rm -i'
# alias cp='cp -i'
# alias mv='mv -i'

# Color man pages
export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_md=$'\E[01;31m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'                           
export LESS_TERMCAP_so=$'\E[01;44;33m'                                 
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;32m'


function fawk {
	first="awk '{print "
        last="}'"
	cmd="${first}\$${1}${last}"
	eval $cmd
}

genpasswd() {
	local l=$1
	[ "$l" == "" ] && l=20
	tr -dc A-Za-z0-9_ < /dev/urandom | head -c ${l} | xargs
}

# allows history searching with ctrl-S
stty -ixon

# Stop the pc speaker from beaping
setterm -bfreq 0
        
# Virtualenv wrapper
#export WORKON_HOME=$HOME/.virtualenvs
#if [[ -f $HOME/.bashrc.d/virtualenvwrapper_bashrc ]]; then
#	source $HOME/.bashrc.d/virtualenvwrapper_bashrc
#fi

# SSH settings and agent automation
alias ssh='if [ "$(ssh-add -l)" = "The agent has no identities." ]; then ssh-add; fi; /usr/bin/ssh "$@"'

if [[ -f ~/.ssh-agent ]]; then
	source $HOME/.ssh-agent
fi

if [[ -f /etc/bash_completion ]]; then
	source /etc/bash_completion
fi
